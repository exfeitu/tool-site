---
import Layout from '../../layouts/Layout.astro';

const config = {
  slug: 'csv-to-json',
  title: 'CSV to JSON Converter - Convert CSV to JSON Online Free',
  description: 'Convert CSV to JSON online for free. Paste your CSV data and instantly get JSON output. Supports headers, nested data, and large files. No signup required.',
  keywords: 'csv to json, convert csv to json, csv to json converter, csv file to json, csv to json online, csv to json python, parse csv to json',
};

const faqSchema = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": [
    {
      "@type": "Question",
      "name": "How to convert CSV to JSON?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Paste your CSV data into the input box and click 'Convert to JSON'. The first row will be used as keys for the JSON objects."
      }
    },
    {
      "@type": "Question",
      "name": "Does CSV to JSON support headers?",
      "acceptedAnswer": {
        "@type": "Answer",
        "text": "Yes! The first row of your CSV is automatically treated as headers and becomes the keys in the JSON output."
      }
    }
  ]
};
---

<Layout title={config.title} description={config.description} keywords={config.keywords}>
  <script type="application/ld+json">
    {JSON.stringify(faqSchema)}
  </script>
  <div class="max-w-4xl mx-auto px-4">
    <div class="mb-8">
      <h1 class="text-4xl font-bold text-gray-900 mb-3">
        üìä CSV to JSON Converter
      </h1>
      <p class="text-lg text-gray-600">
        Convert CSV to JSON instantly. Paste your CSV data and get JSON output. Fast, secure, and completely free.
      </p>
    </div>

    <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
      <div class="mb-6">
        <div class="block text-sm font-semibold text-gray-700 mb-2">
          üìù Paste your CSV here:
        </div>
        <textarea
          id="csv-input"
          class="w-full h-48 p-4 border-2 border-gray-300 rounded-lg font-mono text-sm focus:border-blue-500 focus:outline-none resize-none"
          placeholder="name,age,city&#10;John,30,New York&#10;Jane,25,London"
        ></textarea>
        <p class="text-xs text-gray-500 mt-1">
          üí° Tip: First row should be headers
        </p>
      </div>

      <div class="flex gap-3 mb-6">
        <button
          id="convert-btn"
          class="bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors shadow-md"
        >
          üîÑ Convert to JSON
        </button>
        <button
          id="clear-btn"
          class="bg-gray-200 text-gray-700 px-6 py-3 rounded-lg font-semibold hover:bg-gray-300 transition-colors"
        >
          üóëÔ∏è Clear
        </button>
      </div>

      <div>
        <div class="block text-sm font-semibold text-gray-700 mb-2">
          üìÑ JSON Output:
        </div>
        <textarea
          id="json-output"
          class="w-full h-48 p-4 border-2 border-gray-300 rounded-lg font-mono text-sm bg-gray-50 resize-none"
          readonly
          placeholder="Your JSON will appear here..."
        ></textarea>
      </div>

      <button
        id="copy-btn"
        class="mt-4 bg-green-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-green-700 transition-colors shadow-md hidden"
      >
        üìã Copy to Clipboard
      </button>

      <div id="error-output" class="hidden mt-4 p-4 bg-red-50 border-2 border-red-200 rounded-lg text-red-700"></div>
    </div>

    <div class="bg-white rounded-lg shadow-lg p-6 mb-8">
      <h2 class="text-2xl font-bold text-gray-900 mb-4">Example</h2>
      <div class="space-y-4">
        <div>
          <h3 class="font-semibold text-gray-900 mb-2">Input (CSV):</h3>
          <pre class="bg-gray-100 p-4 rounded-lg overflow-x-auto text-sm"><code>name,age,city
John,30,New York
Jane,25,London</code></pre>
        </div>
        <div class="text-center text-gray-400 text-2xl">‚Üì</div>
        <div>
          <h3 class="font-semibold text-gray-900 mb-2">Output (JSON):</h3>
          <pre class="bg-gray-100 p-4 rounded-lg overflow-x-auto text-sm"><code>{`[
  {"name":"John","age":"30","city":"New York"},
  {"name":"Jane","age":"25","city":"London"}
]`}</code></pre>
        </div>
      </div>
    </div>

    <div class="bg-gray-100 rounded-lg p-6">
      <h2 class="text-xl font-bold text-gray-900 mb-3">Related Tools</h2>
      <div class="flex gap-3 flex-wrap">
        <a href="/tools/json-to-csv" class="text-blue-600 hover:text-blue-800 font-medium">JSON to CSV</a>
        <span class="text-gray-300">‚Ä¢</span>
        <a href="/tools/json-beautifier" class="text-blue-600 hover:text-blue-800 font-medium">JSON Beautifier</a>
        <span class="text-gray-300">‚Ä¢</span>
        <a href="/tools/json-validator" class="text-blue-600 hover:text-blue-800 font-medium">JSON Validator</a>
      </div>
    </div>
  </div>

  <script is:inline>
    const convertBtn = document.getElementById('convert-btn');
    const clearBtn = document.getElementById('clear-btn');
    const copyBtn = document.getElementById('copy-btn');
    const csvInput = document.getElementById('csv-input');
    const jsonOutput = document.getElementById('json-output');
    const errorOutput = document.getElementById('error-output');

    if (convertBtn) {
      convertBtn.addEventListener('click', () => {
        const input = csvInput.value.trim();
        
        if (!input) {
          showError('Please paste CSV data first');
          return;
        }

        try {
          const lines = input.split('\n').filter(line => line.trim());
          if (lines.length < 2) {
            showError('CSV must have at least a header row and one data row');
            return;
          }

          const headers = lines[0].split(',').map(h => h.trim());
          const result = [];

          for (let i = 1; i < lines.length; i++) {
            const values = lines[i].split(',').map(v => v.trim());
            const obj = {};
            headers.forEach((header, index) => {
              obj[header] = values[index] || '';
            });
            result.push(obj);
          }

          jsonOutput.value = JSON.stringify(result, null, 2);
          if (copyBtn) {
            copyBtn.classList.remove('hidden');
          }
          errorOutput.classList.add('hidden');
        } catch (e) {
          showError(`Conversion error: ${e.message}`);
        }
      });
    }

    if (copyBtn) {
      copyBtn.addEventListener('click', () => {
        jsonOutput.select();
        document.execCommand('copy');
        const originalText = copyBtn.textContent;
        copyBtn.textContent = '‚úÖ Copied!';
        setTimeout(() => {
          copyBtn.textContent = originalText;
        }, 2000);
      });
    }

    if (clearBtn) {
      clearBtn.addEventListener('click', () => {
        csvInput.value = '';
        jsonOutput.value = '';
        if (copyBtn) {
          copyBtn.classList.add('hidden');
        }
        errorOutput.classList.add('hidden');
      });
    }

    function showError(message) {
      errorOutput.textContent = message;
      errorOutput.classList.remove('hidden');
      jsonOutput.value = '';
      if (copyBtn) {
        copyBtn.classList.add('hidden');
      }
    }
  </script>
</Layout>


